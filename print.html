
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>طباعة البوليصات</title>
  <style>
    @media print {
      @page {
        size: 95mm 145mm;
        margin: 5mm;
      }
      body {
        margin: 0;
      }
      .label {
        page-break-after: always;
        width: 85mm;
        height: 135mm;
        border: 1px solid #000;
        padding: 5mm;
        box-sizing: border-box;
        font-family: "Arial", sans-serif;
        position: relative;
      }
    }

    body {
      font-family: "Arial", sans-serif;
      background: #eee;
      padding: 10px;
    }

    .label {
      background: #fff;
      margin: 10px auto;
      width: 85mm;
      height: 135mm;
      border: 1px solid #000;
      padding: 5mm;
      box-sizing: border-box;
    }

    h2 {
      font-size: 16px;
      margin: 0 0 5px;
    }

    .cod {
      position: absolute;
      top: 5mm;
      left: 5mm;
      background: black;
      color: white;
      padding: 3px 10px;
      font-weight: bold;
    }

    .section {
      margin-bottom: 5px;
      font-size: 12px;
    }

    .order-number {
      position: absolute;
      bottom: 5mm;
      left: 5mm;
      font-size: 14px;
      font-weight: bold;
    }
  </style>
</head>
<body>

<script>
  const orders = JSON.parse(localStorage.getItem("print_orders") || "[]");
  if (!orders.length) {
    document.body.innerHTML = "<h3>لا توجد بوليصات للطباعة.</h3>";
  } else {
    orders.forEach(o => {
      const div = document.createElement("div");
      div.className = "label";
      div.innerHTML = `
        <div class="cod">COD</div>
        <h2>واحة التقنية اكسبريس</h2>
        <div class="section">منطقة الرياض، حريملاء</div>
        <div class="section">جوال: 0506071823</div>
        <hr>
        <div class="section"><strong>العميل:</strong> ${o["اسم العميل"] || ""}</div>
        <div class="section"><strong>رقم الطلب:</strong> ${o["رقم الطلب"] || ""}</div>
        <div class="section"><strong>الجوال:</strong> ${o["رقم الجوال"] || ""}</div>
        <div class="section"><strong>العنوان:</strong> ${o["عنوان العميل"] || ""}</div>
        ${o["ملاحظة"] ? `<div class="section"><strong>ملاحظة:</strong> ${o["ملاحظة"]}</div>` : ""}
        <div class="order-number">${o["رقم الطلب"] || ""}</div>
      `;
      document.body.appendChild(div);
    });

    setTimeout(() => window.print(), 500);
  }
</script>

</body>
</html>
